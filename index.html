<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png?v=1">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png?v=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Violet Hill Dashboard</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


     <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!--  Paper Dashboard core CSS    -->
    <link href="assets/css/paper-dashboard.css" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="assets/css/demo.css" rel="stylesheet" />


    <!--  Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
    <link href="assets/css/themify-icons.css" rel="stylesheet">
</head>

<body>
	<div class="wrapper">
		<div class="sidebar" data-background-color="brown" data-active-color="danger">
	    <!--
			Tip 1: you can change the color of the sidebar's background using: data-background-color="white | brown"
			Tip 2: you can change the color of the active button using the data-active-color="primary | info | success | warning | danger"
		-->
			<div class="logo">
				<a href="#" class="simple-text logo-mini">
					VH
				</a>

				<a href="#" class="simple-text logo-normal">
					Violet Hill
				</a>
			</div>
	    	<div class="sidebar-wrapper">
				<div class="user">
	                <div class="info">
						<a data-toggle="collapse" href="#collapseExample" class="collapsed">
                            <span>
								<span id="domName"></span>
		                        <b class="caret"></b>
							</span>
	                    </a>
						<div class="clearfix"></div>

	                    <div class="collapse" id="collapseExample">
	                        <ul class="nav">
	                            <li>
									<a href="#profile">
										<span class="sidebar-mini">Mp</span>
										<span class="sidebar-normal">My Profile</span>
									</a>
								</li>
	                            <li>
									<a href="#edit">
										<span class="sidebar-mini">Ep</span>
										<span class="sidebar-normal">Edit Profile</span>
									</a>
								</li>
	                            <li>
									<a href="#settings">
										<span class="sidebar-mini">L</span>
										<span class="sidebar-normal">Logout</span>
									</a>
								</li>
	                        </ul>
	                    </div>
	                </div>
	            </div>
	            <ul class="nav">
					<li>
	                    <a data-toggle="collapse" href="#dashboardOverview">
	                        <i class="ti-panel"></i>
	                        <p>Dashboard
                                <b class="caret"></b>
                            </p>
	                    </a>
                        <div class="collapse" id="dashboardOverview">
							<ul class="nav">
								<li>
									<a href="#">
										<span class="sidebar-mini">O</span>
										<span class="sidebar-normal">Overview</span>
									</a>
								</li>
								<li>
									<a href="#">
										<span class="sidebar-mini">S</span>
										<span class="sidebar-normal">Stats</span>
									</a>
								</li>
							</ul>
						</div>
	                </li>
	            </ul>
	    	</div>
	    </div>

	    <div class="main-panel">
			<nav class="navbar navbar-default">
	            <div class="container-fluid">
					<div class="navbar-minimize">
						<button id="minimizeSidebar" class="btn btn-fill btn-icon"><i class="ti-more-alt"></i></button>
					</div>
	                <div class="navbar-header">
	                    <button type="button" class="navbar-toggle">
	                        <span class="sr-only">Toggle navigation</span>
	                        <span class="icon-bar bar1"></span>
	                        <span class="icon-bar bar2"></span>
	                        <span class="icon-bar bar3"></span>
	                    </button>
	                    <a class="navbar-brand" href="#">My Dashboard</a>
	                </div>
	            </div>
	        </nav>

	        <div class="content">
                    <!-- Trigger the modal with a button -->

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Create your Message</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="modalMessage">Message:</label>
          <textarea class="form-control" rows="5" id="modalMessage"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" onclick="alert(modalType);">Send Message</button>
      </div>
    </div>

  </div>
</div>
</body>
	            <div class="container-fluid">
                    <h3>Matches for your company in <strong id="domIndustry"></strong></h3><br>
	                <div class="row">
	                    <div class="col-md-12">
	                        <div class="card">
	                            <div class="card-content">
	                                <div class="toolbar">
	                                    <!--Here you can write extra buttons/actions for the toolbar-->
	                                </div>
                                    <p id="bootstrap-table-loading">Loading results...</p>
	                                <table id="bootstrap-table" class="table" style="display:none;">
	                                    <thead>
	                                        <th data-field="state" data-checkbox="true"></th>
	                                    	<th data-field="name" data-sortable="true">Name</th>
	                                    	<th data-field="city">City</th>
                                            <th data-field="house_value">House Value</th>
	                                    	<th data-field="actions" class="td-actions text-right" data-events="operateEvents" data-formatter="operateFormatter">Actions</th>
	                                    </thead>
	                                    <tbody id="domResults">
	                                        <tr>
	                                            <td></td>
	                                        	<td>Dakota Rice</td>
	                                        	<td>Menlo Park</td>
                                                <td>$36,738</td>
	                                        	<td>
                                                    <button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#myModal" onclick="modalType='1/email'; updateModal('Dakota');">Email</button>
                                                    <button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#myModal" onclick="modalType='1/mail'; updateModal('Dakota');">Mail</button>
                                                </td>
	                                        </tr>
	                                    </tbody>
	                                </table>
	                            </div>
	                        </div><!--  end card  -->
	                    </div> <!-- end col-md-12 -->
	                </div> <!-- end row -->
	            </div>
	    	</div>
		</div>
	</div>

	<!--   Core JS Files. Extra: TouchPunch for touch library inside jquery-ui.min.js   -->
	<script src="assets/js/jquery-3.1.1.min.js" type="text/javascript"></script>
	<script src="assets/js/jquery-ui.min.js" type="text/javascript"></script>
	<script src="assets/js/perfect-scrollbar.min.js" type="text/javascript"></script>
	<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>

	<!--  Forms Validations Plugin -->
	<script src="assets/js/jquery.validate.min.js"></script>

	<!-- Promise Library for SweetAlert2 working on IE -->
	<script src="assets/js/es6-promise-auto.min.js"></script>

	<!--  Plugin for Date Time Picker and Full Calendar Plugin-->
	<script src="assets/js/moment.min.js"></script>

	<!--  Date Time Picker Plugin is included in this js file -->
	<script src="assets/js/bootstrap-datetimepicker.js"></script>

	<!--  Select Picker Plugin -->
	<script src="assets/js/bootstrap-selectpicker.js"></script>

	<!--  Switch and Tags Input Plugins -->
	<script src="assets/js/bootstrap-switch-tags.js"></script>

	<!-- Circle Percentage-chart -->
	<script src="assets/js/jquery.easypiechart.min.js"></script>

	<!--  Charts Plugin -->
	<script src="assets/js/chartist.min.js"></script>

	<!--  Notifications Plugin    -->
	<script src="assets/js/bootstrap-notify.js"></script>

	<!-- Sweet Alert 2 plugin -->
	<script src="assets/js/sweetalert2.js"></script>

	<!-- Vector Map plugin -->
	<script src="assets/js/jquery-jvectormap.js"></script>

	<!--  Google Maps Plugin    -->
	<!--<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>-->

	<!-- Wizard Plugin    -->
	<script src="assets/js/jquery.bootstrap.wizard.min.js"></script>

	<!--  Bootstrap Table Plugin    -->
	<script src="assets/js/bootstrap-table.js"></script>

	<!--  Plugin for DataTables.net  -->
	<script src="assets/js/jquery.datatables.js"></script>

	<!--  Full Calendar Plugin    -->
	<script src="assets/js/fullcalendar.min.js"></script>

	<!-- Paper Dashboard PRO Core javascript and methods for Demo purpose -->
	<script src="assets/js/paper-dashboard.js"></script>

	<!-- Paper Dashboard PRO DEMO methods, don't include it in your project! -->
	<script src="assets/js/demo.js"></script>

	<script type="text/javascript">
        $(document).ready(function(){
			demo.initWizard();
		});
	</script>
    
    <script>
        
        // source: https://goo.gl/bxtztS
        var QueryString = function () {
          // This function is anonymous, is executed immediately and 
          // the return value is assigned to QueryString!
          var query_string = {};
          var query = window.location.search.substring(1);
          var vars = query.split("&");
          for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
                // If first entry with this name
            if (typeof query_string[pair[0]] === "undefined") {
              query_string[pair[0]] = decodeURIComponent(pair[1]);
                // If second entry with this name
            } else if (typeof query_string[pair[0]] === "string") {
              var arr = [ query_string[pair[0]],decodeURIComponent(pair[1]) ];
              query_string[pair[0]] = arr;
                // If third or later entry with this name
            } else {
              query_string[pair[0]].push(decodeURIComponent(pair[1]));
            }
          } 
          return query_string;
        }();
        
        if(!QueryString.email || !QueryString.elevator_pitch) window.location = "wizard.html";
        
        var fullName = QueryString.first_name + " "  + QueryString.last_name;
        $("#domName").html(fullName);
        var industry = QueryString.industry;
        $("#domIndustry").html(industry.replace(/\+/g, " "));
        
        var updateModal = function(modalRecipient) {
            var modalMessage = "Hi " + modalRecipient + ",\n\n" + QueryString.elevator_pitch.replace(/\+/g, " ") + "\n\nBest,\n" + fullName;
            $("#modalMessage").html(modalMessage);
        }
        
        updateModal("there");
        String.prototype.toProperCase = function () {
            return this.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
        };
        
        $.get("http://violethill.joseb.me/users", function(data) {
            var result = "";
                for(var i = 0; i < 20; i++) {
                    var entry = data[i];
                        var address = entry.address;
                        if(address === undefined) var city = "unknown";
                        else {
                            var city = address.substring(address.indexOf(",") + 2);
                            city = city.substring(0, city.indexOf(","));
                        }
                    if(entry.first_name === undefined) {
                        var contact = "there";
                        entry.first_name = "unknown";
                        entry.last_name = "";
                    }
                    else var contact = entry.first_name;
                    
                    if(entry.value !== undefined)
                        result += "<tr>" +
                                    "<td></td>" +
                                    "<td>" + entry.first_name.toProperCase() + " " + entry.last_name.toProperCase() + "</td>" +
                                    "<td>" + city + "</td>" +
                                    "<td>$" + entry.value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,') + "</td>" +
                                    "<td>" + 
                                        "<button type=\"button\" class=\"btn btn-info btn-sm\" data-toggle=\"modal\" data-target=\"#myModal\" onclick=\"modalType='" + entry._id + "/email'; updateModal('" + entry.first_name.toProperCase() + "');\">Email</button>" + 
                                        "<button type=\"button\" class=\"btn btn-info btn-sm\" data-toggle=\"modal\" data-target=\"#myModal\" onclick=\"modalType='" + entry._id + "/mail'; updateModal('" + entry.first_name.toProperCase() + "');\">Mail</button>" +
                                    "</td>" +
                                "</tr>";
                }
            $("#domResults").html(result);
            $("#bootstrap-table").show();
            $("#bootstrap-table-loading").hide();
        });
        
        
        var address = "2312 Warner Range Ave, Menlo Park, CA 94025";
        var city = address.substring(address.indexOf(",") + 2);
        city = city.substring(0, city.indexOf(","));
        console.log("address:", address, "city:", city);
        
        var modalType = "";
    </script>

</html>
